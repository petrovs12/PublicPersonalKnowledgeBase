<h1 id="interop">Interop<a aria-hidden="true" class="anchor-heading icon-link" href="#interop"></a></h1>
<h1 id="thrift">Thrift<a aria-hidden="true" class="anchor-heading icon-link" href="#thrift"></a></h1>
<p>Can use it to say define a service:</p>
<pre><code>exception CustomException {
  1: string message;
}

struct AddResult {
  1: i32 sum;
}

service Calculator {
  AddResult add(1:i32 a, 2:i32 b) throws (1:CustomException ex);
}

</code></pre>
<p>then generate fome python sclenecton:</p>
<pre><code>thrift --getn py cancleator.thrift
</code></pre>
<p>Then the python snippet willbe like so:</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">import</span> calculator<span class="token punctuation">.</span>Calculator <span class="token keyword">as</span> Calculator

<span class="token keyword">class</span> <span class="token class-name">CalculatorHandler</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> a <span class="token operator">&#x3C;</span> <span class="token number">0</span> <span class="token keyword">or</span> b <span class="token operator">&#x3C;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> Calculator<span class="token punctuation">.</span>CustomException<span class="token punctuation">(</span><span class="token string">"Both numbers must be non-negative"</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> Calculator<span class="token punctuation">.</span>AddResult<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token operator">=</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span>

handler <span class="token operator">=</span> CalculatorHandler<span class="token punctuation">(</span><span class="token punctuation">)</span>
processor <span class="token operator">=</span> Calculator<span class="token punctuation">.</span>Processor<span class="token punctuation">(</span>handler<span class="token punctuation">)</span>
transport <span class="token operator">=</span> TSocket<span class="token punctuation">.</span>TServerSocket<span class="token punctuation">(</span>port<span class="token operator">=</span><span class="token number">9090</span><span class="token punctuation">)</span>
server <span class="token operator">=</span> TServer<span class="token punctuation">.</span>TSimpleServer<span class="token punctuation">(</span>processor<span class="token punctuation">,</span> transport<span class="token punctuation">)</span>
server<span class="token punctuation">.</span>serve<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
<p>And the clinent as so:</p>
<pre class="language-cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&#x3C;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&#x3C;thrift/transport/TBufferTransports.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&#x3C;thrift/protocol/TBinaryProtocol.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Calculator.h"</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> apache<span class="token double-colon punctuation">::</span>thrift<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> apache<span class="token double-colon punctuation">::</span>thrift<span class="token double-colon punctuation">::</span>protocol<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> apache<span class="token double-colon punctuation">::</span>thrift<span class="token double-colon punctuation">::</span>transport<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> <span class="token double-colon punctuation">::</span>calculator<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&#x3C;</span>TTransport<span class="token operator">></span> <span class="token function">socket</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">TSocket</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token number">9090</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&#x3C;</span>TTransport<span class="token operator">></span> <span class="token function">transport</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">TBufferedTransport</span><span class="token punctuation">(</span>socket<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&#x3C;</span>TProtocol<span class="token operator">></span> <span class="token function">protocol</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">TBinaryProtocol</span><span class="token punctuation">(</span>transport<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CalculatorClient <span class="token function">client</span><span class="token punctuation">(</span>protocol<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        AddResult result <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&#x3C;&#x3C;</span> <span class="token string">"3 + 4 = "</span> <span class="token operator">&#x3C;&#x3C;</span> result<span class="token punctuation">.</span>sum <span class="token operator">&#x3C;&#x3C;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>

        client<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>CustomException<span class="token operator">&#x26;</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&#x3C;&#x3C;</span> <span class="token string">"Caught custom exception: "</span> <span class="token operator">&#x3C;&#x3C;</span> ex<span class="token punctuation">.</span>message <span class="token operator">&#x3C;&#x3C;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    transport<span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
<p>Note the port above in the cpp code.
Evene if this doesn't work great, iit should be representing the relationships between the components well enough.</p>