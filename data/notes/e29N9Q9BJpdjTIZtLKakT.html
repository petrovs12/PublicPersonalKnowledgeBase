<h1 id="coroutines">coroutines<a aria-hidden="true" class="anchor-heading icon-link" href="#coroutines"></a></h1>
<h1 id="example-of-a-coroutine-for-determinign-market-price-of-an-asset">Example of a coroutine for determinign market price of an asset,<a aria-hidden="true" class="anchor-heading icon-link" href="#example-of-a-coroutine-for-determinign-market-price-of-an-asset"></a></h1>
<p>based on number of people who bet 'buy'</p>
<p><a href="/PublicPersonalKnowledgeBase/notes/iVihxryqowlWwSBwWgZGr">Various</a>
'''{python}
Created on Aug 23, 2012
<a title="Private" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank" class="private">@author (Private)</a>: Stefan1
import random
def suppDem(bids):
if(len(bids)==0):
return 0
return random.normalvariate(sum(bids),sum(bids))/len(bids)
def priceGenCoroutine(initialPrice=0,priceUpdateMechanism=suppDem):
currentPrice=initialPrice
while True:
currentPrice+=suppDem((yield currentPrice))</p>
<p>def stochasticTrendFollow(prices):
if(len(prices)&#x3C;2):
return random.normalvariate(0,0.5)
return random.normalvariate((prices[-1]-prices[-2]),0.5)
def AgentCoroutine(strategy=stochasticTrendFollow):
obsPrices=[]
currentBid=0
while True:
obsPrices.append((yield currentBid))
currentBid=strategy(obsPrices)</p>
<p>if <strong>name</strong> == '<strong>main</strong>':
numAgents=10
market=priceGenCoroutine()
agents=[AgentCoroutine() for i in range(numAgents)]
for ag in agents:
next(ag)
numSteps=10
currPrice=next(market)
for i in range(numSteps):
bids=[]
print (currPrice)
for ag in agents:
bids.append(ag.send(currPrice))
currPrice=market.send(bids)</p>
<pre><code></code></pre>