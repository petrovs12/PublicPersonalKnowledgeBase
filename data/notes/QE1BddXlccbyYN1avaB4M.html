<h1 id="recommender-systems">Recommender Systems<a aria-hidden="true" class="anchor-heading icon-link" href="#recommender-systems"></a></h1>
<h1 id="why-recsys">Why Recsys?<a aria-hidden="true" class="anchor-heading icon-link" href="#why-recsys"></a></h1>
<p>Item space, user space.
Very high value to customer and commercial.
Items can be other users too, i.e. tinder.</p>
<h1 id="references">References<a aria-hidden="true" class="anchor-heading icon-link" href="#references"></a></h1>
<p><a href="https://pdfs.semanticscholar.org/b474/56864177f79b0ef1b00ac923527aac256ffc.pdf">Matrix Factorization Report</a>.</p>
<h1 id="requirements">Requirements<a aria-hidden="true" class="anchor-heading icon-link" href="#requirements"></a></h1>
<h2 id="functional">Functional<a aria-hidden="true" class="anchor-heading icon-link" href="#functional"></a></h2>
<p> Enjoyable content
Increasing Revenue
Fairness (across demographic strata)
Fairness (across items)
Diversity of content (serendipity)</p>
<h2 id="non-functional">Non-functional<a aria-hidden="true" class="anchor-heading icon-link" href="#non-functional"></a></h2>
<ul>
<li>Availability</li>
<li>Low latency</li>
</ul>
<h1 id="system-overview">System Overview<a aria-hidden="true" class="anchor-heading icon-link" href="#system-overview"></a></h1>
<h2 id="scalability-concern-1">Scalability Concern 1<a aria-hidden="true" class="anchor-heading icon-link" href="#scalability-concern-1"></a></h2>
<div class="mermaid">
  graph LR;
a["Corpus(10^9s)"];
b["Candidates(100's)"]
c["Top Candidates(10's)"]
d["Top Recommendations(ordered))"]

a--scoring-->b--complex re-scoring-->c--ranking,selection-->d
</div>
<h1 id="high-level-description-on-priorities-ml-approach-at-each-stage-above">High-level description on priorities/ ML approach at each stage above<a aria-hidden="true" class="anchor-heading icon-link" href="#high-level-description-on-priorities-ml-approach-at-each-stage-above"></a></h1>
<h1 id="first-pass-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^candidate_generation" href="#^candidate_generation"></a>First Pass <a aria-hidden="true" class="anchor-heading icon-link" href="#first-pass-"></a></h1>
<p>To get from <strong>Corpus</strong> to <strong>Candidates</strong></p>
<p>quick-ish models, fast collaborative filtering,etc.</p>
<p>KNN w/ random projection or local hashing, etc.
<a href="/PublicPersonalKnowledgeBase/notes/q6bc1dvnjytciisll1b9uh2">High Dimensional Neighborhood Search</a>
<a href="/PublicPersonalKnowledgeBase/notes/ohfk4ao5xo2zijxcchgutju">Random Projections</a></p>
<h1 id="second-pass">Second Pass<a aria-hidden="true" class="anchor-heading icon-link" href="#second-pass"></a></h1>
<p>Bigger models, use everything possible, user activity etc.
<a href="https://d2l.ai/chapter_recommender-systems/index.html">possible recsys architectures</a>.</p>
<p>All tricks about cold start, session models, etc also come here.</p>
<h1 id="third-pass-re-ranking">Third pass re-Ranking<a aria-hidden="true" class="anchor-heading icon-link" href="#third-pass-re-ranking"></a></h1>
<p>Add constraints (already seen this item, has clicked 'not interested' on similar, etc).
Add freshness, fairness, diversity.
Maybe use some linear programming or other stuff to optimize something close to business objective.</p>
<h1 id="data">Data<a aria-hidden="true" class="anchor-heading icon-link" href="#data"></a></h1>
<h2 id="user-features">User features:<a aria-hidden="true" class="anchor-heading icon-link" href="#user-features"></a></h2>
<p>login date, demographics</p>
<h2 id="item-features">Item features<a aria-hidden="true" class="anchor-heading icon-link" href="#item-features"></a></h2>
<p>Item content features- description, publisher, category, images, video snapshots. Tags, publisher tags,
tags from image/video object detection algos, etc.</p>
<h1 id="item-user-interaction">Item-user Interaction<a aria-hidden="true" class="anchor-heading icon-link" href="#item-user-interaction"></a></h1>
<ul>
<li>Rating</li>
<li>Purchase</li>
<li>Other stuff</li>
</ul>
<h1 id="feature-engineering">Feature Engineering<a aria-hidden="true" class="anchor-heading icon-link" href="#feature-engineering"></a></h1>
<ul>
<li>Normalization of ratings</li>
</ul>
<h2 id="implicit-and-explicit-signals-combining-them-implicit-explicit-signal">Implicit and Explicit Signals, combining them ^implicit-explicit signal<a aria-hidden="true" class="anchor-heading icon-link" href="#implicit-and-explicit-signals-combining-them-implicit-explicit-signal"></a></h2>
<p>Summary:
implicit feedback based models seem better for ranking predictions, much richer, but if
basing only on implicit feedback, might have popularity bias.
</p><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Recommender Systems</span></div>
<a href="/PublicPersonalKnowledgeBase/notes/VG6JMpj1Lic8br5iTSvIL" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><ol>
<li><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^popularity-bias-implicit" href="#^popularity-bias-implicit"></a>A problem for this might be that the 'head' of the implicit feedback might be biased towards popular items, it might lack serendipity, surprise, discovery, fairness etc. </li>
</ol>
</div></div><p></p><p></p>
<p> Metrics</p>
<ul>
<li><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Loss Functions</span></div>
<a href="/PublicPersonalKnowledgeBase/notes/pBIMmRuN5zKHlVDIWn2wt" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><h1 id="ranking-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^ranking-start" href="#^ranking-start"></a>Ranking <a aria-hidden="true" class="anchor-heading icon-link" href="#ranking-"></a></h1>
</div></div><p></p>
<p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Loss Functions</span></div>
<a href="/PublicPersonalKnowledgeBase/notes/pBIMmRuN5zKHlVDIWn2wt" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><h1 id="ranking--1"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^ranking-start" href="#^ranking-start"></a>Ranking <a aria-hidden="true" class="anchor-heading icon-link" href="#ranking--1"></a></h1>
<h2 id="types-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^ranking-metrics" href="#^ranking-metrics"></a>Types <a aria-hidden="true" class="anchor-heading icon-link" href="#types-"></a></h2>
<ul>
<li><strong>Point-wise models</strong>: which try to predict a (matching) score for each query-document pair in the dataset, and use it for ranking the items.</li>
<li><strong>Pair-wise models</strong>: which try to learn a <strong>binary classifier</strong> that can tell which document is more relevant to a query, given pair of documents.</li>
<li><strong>List-wise models</strong>: which try to directly optimize the value of one of the above evaluation measures, averaged over all queries in the training data.</li>
</ul>
<p><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^ranking-metrics" href="#^ranking-metrics"></a><a href="https://towardsdatascience.com/20-popular-machine-learning-metrics-part-2-ranking-statistical-metrics-22c3e5a937b6">Some Medium Article</a> </p>
<p><a title="Private" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank" class="private">#TODO- (Private)</a> learn some of these</p>
<ul>
<li>
<p>Mean Reciprocal Rank (MRR)</p>
<pre><code>For each user and each relevant item, compute 
the mean precision of the list __trough__ that item

</code></pre>
</li>
</ul>
<h2 id="ranking--binary-relevance">Ranking- Binary Relevance<a aria-hidden="true" class="anchor-heading icon-link" href="#ranking--binary-relevance"></a></h2>
<h3 id="mean-average-precision-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^ranking-map" href="#^ranking-map"></a>Mean Average Precision <a aria-hidden="true" class="anchor-heading icon-link" href="#mean-average-precision-"></a></h3>
<p> Define 'precision trough k' to mean 'how many items until the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mi>t</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">k-th</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span></span></span></span></span> are relevant. The average of these is the Average Precision. The mean of that is the loss of the ranker.</p>
<ol start="0">
<li>
<p><strong>MAXIMIZE</strong></p>
</li>
<li>
<p>For each query, compute <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>P</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">AP(q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span></span></span> (average precision). To compute average precision, compute first <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>I</mi><mo stretchy="false">(</mo><msub><mn>1</mn><mtext>user clicked on 1st result</mtext></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P_1(q) = I(1_{\text{user clicked on 1st result}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">user clicked on 1st result</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1..</mn><mi>k</mi></mrow></msub><mi>I</mi><mo stretchy="false">(</mo><msub><mn>1</mn><mtext>user clicked on i-th result</mtext></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P_k(q) =\sum_{i=1..k} I(1_{\text{user clicked on i-th result}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0497em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1..</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">user clicked on i-th result</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><msub><mi>P</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msub><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1..</mn><mi>k</mi></mrow></msub><msub><mi>P</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><mi>k</mi></mfrac></mrow><annotation encoding="application/x-tex">AP_k(q) =\frac{\sum_{i=1..k} P_k(q)}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.405em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.06em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.535em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1746em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1..</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3214em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
</li>
<li>
<p>The MAP is the mean of these for a given ranking algorithm.</p>
</li>
</ol>
<h3 id="mean-reciprocal-rank-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^ranking-mar" href="#^ranking-mar"></a>Mean Reciprocal Rank <a aria-hidden="true" class="anchor-heading icon-link" href="#mean-reciprocal-rank-"></a></h3>
<p>The 'performance' is <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">1/i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord mathnormal">i</span></span></span></span></span>, where the highest option we click on is the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>-th one. Then the avg of that is MRR</p>
<ol start="0">
<li><strong>MAXIMIZE</strong></li>
<li>Say we produce <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> options for a query, and the <strong>highest option</strong> (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>O</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">HO(q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span></span></span>) the  user interacts with is the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>-th option. If they don't interact, assume <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>O</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">HO(q)=k+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>R</mi><msub><mi>R</mi><mi>r</mi></msub><mi>e</mi><mi>c</mi><mi>o</mi><mi>m</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>r</mi><mo>=</mo><mfrac><mrow><msub><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1..</mn><mi>Q</mi></mrow></msub><mfrac><mn>1</mn><mrow><mi>H</mi><mi>O</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><mi>Q</mi></mfrac></mrow><annotation encoding="application/x-tex">MRR_recommender =\frac{\sum_{i=1..Q}\frac{1}{HO(q)}}{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">MR</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">eco</span><span class="mord mathnormal">mm</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7586em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2775em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Q</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6865em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1667em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1..</span><span class="mord mathnormal mtight">Q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4603em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.6408em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">O</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5378em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li>
</ol>
<h2 id="ranking--beyond-binary-relevance">Ranking- Beyond Binary Relevance<a aria-hidden="true" class="anchor-heading icon-link" href="#ranking--beyond-binary-relevance"></a></h2>
<p> Assume we know the relevances of the documents. Note- this can be used to differentiate signals in ads between look, click, put in basket, purchase, etc.
So for each document there is a 'relevance ground truth' <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">rel_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">re</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>.
Now, let a query <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span> return the order <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>π</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>π</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\pi_1,\pi_2,...,\pi_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="discounted-cumulative-gain-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^DCG" href="#^DCG"></a>Discounted Cumulative Gain <a aria-hidden="true" class="anchor-heading icon-link" href="#discounted-cumulative-gain-"></a></h3>
<p>We discount things, lower on the list.
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub><mo>=</mo><mi>r</mi><mi>e</mi><msub><mi>l</mi><msub><mi>π</mi><mn>1</mn></msub></msub><mo>+</mo><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>i</mi><mo>=</mo><mn>2..</mn><mi>k</mi></mrow></msub><mo stretchy="false">(</mo><mi>r</mi><mi>e</mi><msub><mi>l</mi><msub><mi>π</mi><mi>i</mi></msub></msub><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">DCG_p = rel_{\pi_1}+sum_{i=2..k}(rel_{\pi_i}/(1+log(i)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9445em;vertical-align:-0.2501em;"></span><span class="mord mathnormal">re</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">2..</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">re</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)))</span></span></span></span></span>
Can also use:</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>C</mi><msub><mi>G</mi><mrow><mo stretchy="false">[</mo><mi>π</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>π</mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo stretchy="false">]</mo></mrow></msub><mo>=</mo><mi>r</mi><mi>e</mi><msub><mi>l</mi><msub><mi>π</mi><mn>1</mn></msub></msub><mo>+</mo><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>i</mi><mo>=</mo><mn>2..</mn><mi>k</mi></mrow></msub><mo stretchy="false">(</mo><msup><mn>2</mn><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><msub><mi>π</mi><mi>i</mi></msub></msub></mrow></msup><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">DCG_{[\pi(1),\pi(2),...]} = rel_{\pi_1}+sum_{i=2..k}(2^{rel_{\pi_i}}/(1+log(i)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span><span class="mpunct mtight">,</span><span class="mord mtight">...</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9445em;vertical-align:-0.2501em;"></span><span class="mord mathnormal">re</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1013em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">2..</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8513em;"><span style="top:-3.0652em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">re</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.0359em;margin-right:0.1em;"><span class="pstrut" style="height:2.6595em;"></span><span class="mord mathnormal mtight">i</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3678em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)))</span></span></span></span></span></p>
<p>which puts very high emphasis on highly relevant documents.</p>
<h2 id="normalized-discounted-cumulative-gain-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^ranking-NDCG" href="#^ranking-NDCG"></a>Normalized Discounted Cumulative Gain <a aria-hidden="true" class="anchor-heading icon-link" href="#normalized-discounted-cumulative-gain-"></a></h2>
<p>normalize DCG by the ideal DCG.</p>
<p>$ DCG_{best}(el_1,el_2,...) = DCG(sortDecsending([el_1,el_2,...])) $</p>
<p>$ NDCG([e_1,e_2,...])= DCG([e_1,e_2,...])/DCG(sortDesc([e_1,e_2,...])) $</p>
<h2 id="precision-at-k-pk">Precision at K ("p@K").<a aria-hidden="true" class="anchor-heading icon-link" href="#precision-at-k-pk"></a></h2>
<p> Precision @ 1: if first item is relevant, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">P_1=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>, else 0.</p>
<h2 id="what-if-no-relevant-results">What if no relevant results<a aria-hidden="true" class="anchor-heading icon-link" href="#what-if-no-relevant-results"></a></h2>
<p>If user does more queries, then can find the reciprocal rank, MRR is the mean RR across multiple queries.</p>
</div></div><p></p></li>
</ul>
<h1 id="item-item-or-user-user-based-similarity-content-based-filtering-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^content-filtering" href="#^content-filtering"></a>Item-item or user-user based similarity (content-based filtering) <a aria-hidden="true" class="anchor-heading icon-link" href="#item-item-or-user-user-based-similarity-content-based-filtering-"></a></h1>
<h2 id="data-1">Data:<a aria-hidden="true" class="anchor-heading icon-link" href="#data-1"></a></h2>
<p>Movie profile:</p>
<ul>
<li>Genre</li>
<li>Producer</li>
<li>Tags</li>
<li>Description (word2vec,doc2vec)</li>
<li>Images and video snapshots (maybe tagging based on that, maybe color pallet)</li>
<li>Thumbnails
<!-- * User search/interest history -->
</li>
</ul>
<p>Maybe latent space of 'interests' that's common to not only this recsys, but
the search as well...</p>
<h1 id="item-user-based-similarity-collaborative-filtering-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^collaborative-filtering" href="#^collaborative-filtering"></a>Item-user based similarity (collaborative filtering) <a aria-hidden="true" class="anchor-heading icon-link" href="#item-user-based-similarity-collaborative-filtering-"></a></h1>
<h1 id="models-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^models" href="#^models"></a>Models <a aria-hidden="true" class="anchor-heading icon-link" href="#models-"></a></h1>
<h2 id="item-item-similarity-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^item-item-similarity" href="#^item-item-similarity"></a>Item-Item Similarity <a aria-hidden="true" class="anchor-heading icon-link" href="#item-item-similarity-"></a></h2>
<ul>
<li>Item KNN</li>
<li>Item Attr</li>
<li>BPRMF</li>
<li>ItemKNN</li>
<li>Item Attribute KNN</li>
<li>UserKNN</li>
<li>User Attribute KNN</li>
<li>Group-based (Clustering-based algorithm)</li>
<li>Paco Recommender (Co-Clustering-based algorithm)</li>
</ul>
<h1 id="algorithms-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^algorithms" href="#^algorithms"></a>Algorithms <a aria-hidden="true" class="anchor-heading icon-link" href="#algorithms-"></a></h1>
<p>For content filtering approaches:</p>
<p>Clustering type things, manifold dimensionality reduction, etc. General unsupervised learning techniques.
<a href="/PublicPersonalKnowledgeBase/notes/8IzHGF5RCHLCesjjpTqRU">Unsupervised Learning</a>
<a href="/PublicPersonalKnowledgeBase/notes/x6WJBarY2rinq6LZVpoAE">KNN</a> </p>
<h2 id="collaborative-filtering-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^collaborative-filtering" href="#^collaborative-filtering"></a>Collaborative Filtering <a aria-hidden="true" class="anchor-heading icon-link" href="#collaborative-filtering-"></a></h2>
<h2 id="item-user-embedding-collaborative-filtering-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^collaborative-filtering-models" href="#^collaborative-filtering-models"></a>Item-User Embedding (Collaborative Filtering)) <a aria-hidden="true" class="anchor-heading icon-link" href="#item-user-embedding-collaborative-filtering-"></a></h2>
<ul>
<li>Matrix Factorization (with and without baseline)</li>
<li>Non-negative Matrix Factorization</li>
<li>SVD</li>
<li>SVD++</li>
<li>ItemKNN</li>
</ul>
<h2 id="optimization-techniques-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^optimization-techniques" href="#^optimization-techniques"></a>Optimization Techniques <a aria-hidden="true" class="anchor-heading icon-link" href="#optimization-techniques-"></a></h2>
<h3 id="stochastic-gradient-descent-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^sgd" href="#^sgd"></a>Stochastic Gradient Descent <a aria-hidden="true" class="anchor-heading icon-link" href="#stochastic-gradient-descent-"></a></h3>
<p><a href="/PublicPersonalKnowledgeBase/notes/DomemlJ4RaKuAJ3oCsuTN">Stochastic Gradient Descent</a></p>
<h3 id="alternating-least-squares-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^als" href="#^als"></a>Alternating Least Squares <a aria-hidden="true" class="anchor-heading icon-link" href="#alternating-least-squares-"></a></h3>
<p>Note in </p><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Recommender Systems</span></div>
<a href="/PublicPersonalKnowledgeBase/notes/VG6JMpj1Lic8br5iTSvIL" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><p><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^svd-loss2" href="#^svd-loss2"></a><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><msub><mi>n</mi><mrow><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo separator="true">,</mo><mi>b</mi></mrow></msub><msub><mi mathvariant="normal">Σ</mi><mrow><mi>u</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>r</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub><mo>−</mo><mi>μ</mi><mo>−</mo><msub><mi>b</mi><mi>u</mi></msub><mo>−</mo><msub><mi>b</mi><mi>i</mi></msub><mo>−</mo><msub><mi>p</mi><mi>u</mi></msub><mi mathvariant="normal">.</mi><msub><mi>q</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>p</mi><mi>u</mi></msub><mi mathvariant="normal">∣</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo>+</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>q</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo>+</mo><msubsup><mi>b</mi><mi>u</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>b</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">min_{p,q,b}\Sigma_{u,i} (r_{ui}-\mu-b_u-b_i-p_u . q_i)^2+\lambda(||p_u||^2+||q_i||^2+b_u^2+b_i^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0611em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0728em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> </p>
</div></div><p></p>
we're optimizing wrt <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">p,q,b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span></span></span></span></span>.
The loss is not convex, BUT if we fix <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">p,b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span></span></span></span></span> we can optimize wrt <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span> with least squares.
Same for fixing <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">q,b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span></span></span></span></span> -<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo separator="true">,</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">q,p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span></span></span></span></span>, which means we can have a sequence of solving quadratic (and I think in this case, convext) problems.<p></p>
<p> Advantages:
massive parallelization, as if we have only the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo separator="true">,</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p,q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span> case, the objective function decomposes across variables!!!
But depends on the objective itself.</p>
<h1 id="cold-start-problem">Cold Start Problem<a aria-hidden="true" class="anchor-heading icon-link" href="#cold-start-problem"></a></h1>
<p>New (or unknown) users or  items.</p>
<h2 id="new-item">New Item<a aria-hidden="true" class="anchor-heading icon-link" href="#new-item"></a></h2>
<p> No historical interaction data.
Typically use item data or baselines.</p>
<ul>
<li>Use item-item model, based on content (item-similarity for current item) <a title="Private" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank" class="private">^item-item-similarity (Private)</a></li>
</ul>
<h2 id="new-user">New User<a aria-hidden="true" class="anchor-heading icon-link" href="#new-user"></a></h2>
<p>Unseen or anonusers - no profile or historical interactions. </p>
<h3 id="user-user-model-based-on-demographic-characteristics">User-user model, based on demographic characteristics<a aria-hidden="true" class="anchor-heading icon-link" href="#user-user-model-based-on-demographic-characteristics"></a></h3>
<h3 id="anonimous-users">Anonimous Users<a aria-hidden="true" class="anchor-heading icon-link" href="#anonimous-users"></a></h3>
<p> If no profile, start showing items (Akinator-style)[https://en.akinator.com/] somehow and try to represent the user a s linear combination of the items seen.</p>
<h2 id="no-collaborative-filtering">No collaborative filtering<a aria-hidden="true" class="anchor-heading icon-link" href="#no-collaborative-filtering"></a></h2>
<p>Item-similarity
Contextual models for short-term history.</p>
<h3 id="intra-session-models">Intra-session models<a aria-hidden="true" class="anchor-heading icon-link" href="#intra-session-models"></a></h3>
<p>From <a href="https://youtu.be/y_TzOOCJqxI?t=1066">this video</a>, we get a session-based recommendation
using such architecture:</p>
<div class="mermaid">
  graph LR;

a["Input 1-hot encoding"];
b["Embedding Layer"];
c["GRU Layer"];
d["GRU Layer"];
e["GRU Layer"];
f["Feedforward layers"];
g["Output: scores on items"];

a-->b-->c-->d-->e-->f-->g
b-->d;
b-->e;
b-->f;
</div>
<p>uses <a href="/PublicPersonalKnowledgeBase/notes/OpdCi2T7nWRqHDhKARCDP">Negative Sampling</a>,#minibatch.</p>
<p><a title="Private" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank" class="private">science.stats.Regression.Metrics:^ranking-start:^ranking-end (Private)</a>: BPR, TOP1.</p>
<h3 id="but-in-fact-neighborhood-based-methods-are-not-much-worse-if-done-properly">But in fact neighborhood based Methods are not much worse if done properly<a aria-hidden="true" class="anchor-heading icon-link" href="#but-in-fact-neighborhood-based-methods-are-not-much-worse-if-done-properly"></a></h3>
<p><a href="https://web-ainf.aau.at/pub/jannach/files/Conference_RecSys_2017.pdf">Debunk on the 20-30% of the last paragraph</a></p>
<h2 id="representing-user-as-linear-combination-of-items">Representing user as linear combination of items<a aria-hidden="true" class="anchor-heading icon-link" href="#representing-user-as-linear-combination-of-items"></a></h2>
<h1 id="discrepency-between-business-goal-metric-and-within-optimizer-loss">Discrepency between 'business goal metric' and 'within-optimizer loss'<a aria-hidden="true" class="anchor-heading icon-link" href="#discrepency-between-business-goal-metric-and-within-optimizer-loss"></a></h1>
<p>Can have variety of final allocators.</p>
<h1 id="fairness-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^fairness" href="#^fairness"></a>Fairness <a aria-hidden="true" class="anchor-heading icon-link" href="#fairness-"></a></h1>
<p><a href="/PublicPersonalKnowledgeBase/notes/74afJvw5CEJWFWkDS8Ri0">Algorithmic Fairness</a></p>
<h2 id="error-is-same-across-groups">Error is same across groups<a aria-hidden="true" class="anchor-heading icon-link" href="#error-is-same-across-groups"></a></h2>
<p></p><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Algorithmic Fairness</span></div>
<a href="/PublicPersonalKnowledgeBase/notes/74afJvw5CEJWFWkDS8Ri0" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><p><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^independence-formula" href="#^independence-formula"></a><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>R</mi><mo>=</mo><mi>r</mi><mi mathvariant="normal">∣</mi><mi>A</mi><mo>=</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>R</mi><mo>=</mo><mi>r</mi><mi mathvariant="normal">∣</mi><mi>A</mi><mo>=</mo><mi>b</mi><mo stretchy="false">)</mo><mspace width="1em"></mspace><mi mathvariant="normal">∀</mi><mi>r</mi><mo>∈</mo><mi>R</mi><mspace width="1em"></mspace><mi mathvariant="normal">∀</mi><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">{P(R=r|A=a)=P(R=r|A=b)\quad \forall r\in R\quad \forall a,b\in A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">∀</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">A</span></span></span></span></span></span> for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span>-result, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span> -sensitive characteristic. </p>
</div></div><p></p><p></p>
<p>Can either model directly or just train algo and then test if erros same (ANOVA, t-test variations etc).</p>
<h1 id="keeping-track-and-serving-of-multiple-models-model-versions-abcd-testingrollbacks">Keeping Track and serving of multiple models, model versions, A/B/C/D... testing,rollbacks<a aria-hidden="true" class="anchor-heading icon-link" href="#keeping-track-and-serving-of-multiple-models-model-versions-abcd-testingrollbacks"></a></h1>
<h2 id="data-structure-for-multiple-models">Data Structure for multiple models<a aria-hidden="true" class="anchor-heading icon-link" href="#data-structure-for-multiple-models"></a></h2>
<h2 id="abcd-testing">A/B/C/D testing<a aria-hidden="true" class="anchor-heading icon-link" href="#abcd-testing"></a></h2>
<h2 id="model-rollback">Model Rollback<a aria-hidden="true" class="anchor-heading icon-link" href="#model-rollback"></a></h2>
<h2 id="train-test-set-splitting">Train-test set splitting<a aria-hidden="true" class="anchor-heading icon-link" href="#train-test-set-splitting"></a></h2>
<p>Probably similar to how we split data for testing in <a href="/PublicPersonalKnowledgeBase/notes/n2WACzfl7879utGwz2RVl">Graph Neural Networks</a></p>
<p></p><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Train Test Splitting</span></div>
<a href="/PublicPersonalKnowledgeBase/notes/6I2g5QI7rldW6fRaQrVsJ" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><h1 id="recommender-system-test-set-split-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^recsys-start" href="#^recsys-start"></a>Recommender System test set split <a aria-hidden="true" class="anchor-heading icon-link" href="#recommender-system-test-set-split-"></a></h1>
</div></div><p></p>
<a href="/PublicPersonalKnowledgeBase/notes/6I2g5QI7rldW6fRaQrVsJ">Train Test Splitting</a><p></p>
<h1 id="moderation">Moderation<a aria-hidden="true" class="anchor-heading icon-link" href="#moderation"></a></h1>
<p>Remove, reduce, inform approach.</p>
<h2 id="remove">Remove<a aria-hidden="true" class="anchor-heading icon-link" href="#remove"></a></h2>
<p>As users upload stuff, it's put in a <a href="/PublicPersonalKnowledgeBase/notes/XTtqgXn9cjxfiseCY7KSn">Message Queues</a> and pool of workers
is processing it for violation of Community standards, forbidden content, abuse, etc.
If confidence is high >99.5%, say, can directly remove.</p>
<h2 id="reduce">Reduce<a aria-hidden="true" class="anchor-heading icon-link" href="#reduce"></a></h2>
<p>Can send stuff above certain threshold for manual moderation. Can have buttons to report, etc,
gain more feedback about it.
Threats, etc.</p>
<h2 id="inform">Inform<a aria-hidden="true" class="anchor-heading icon-link" href="#inform"></a></h2>
<p>Can match clickbait titles, if we detect topic or semantics of a title/article, can check agains
3rd party fact-checkers.</p>
<h1 id="quick-filtering-tricks--"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^filters" href="#^filters"></a>Quick Filtering Tricks  <a aria-hidden="true" class="anchor-heading icon-link" href="#quick-filtering-tricks--"></a></h1>
<p>Some fast algorithms for deleting items for consideration for a certain query.</p>
<h3 id="bloom-filters-for-deleting-forbidden-items">Bloom Filters for deleting forbidden Items<a aria-hidden="true" class="anchor-heading icon-link" href="#bloom-filters-for-deleting-forbidden-items"></a></h3>
<p><a href="/PublicPersonalKnowledgeBase/notes/DGlamf8n85vZa7s6JE1TG#use-in-recommendation-systems">Bloom Filters</a>
Usage- mostly first-pass.</p>
<h3 id="exclusion-of-too-similar-items-from-same-newsfeed">Exclusion of 'too similar' items from same newsfeed<a aria-hidden="true" class="anchor-heading icon-link" href="#exclusion-of-too-similar-items-from-same-newsfeed"></a></h3>
<p>This looks vaguely like <a href="/PublicPersonalKnowledgeBase/notes/CPkp9LKmwAEjdjFjKUA9k">Facility Location</a>, or
<a href="/PublicPersonalKnowledgeBase/notes/8i2m6qqkBscsgEvhQWRxT">Clustering</a> problem. Can, though, solve approximately by a greedy approach where we pick an item and remove from consideration items too similar to it, until correlation/cosine similarity is low enough, pick next item, etc. Always pick the next thing that's dissimilar enough from the previous ones.</p>
<p>See also (Greedy 2-approximation for k-center)[https://ugtcs.berkeley.edu/src/approx-sp19/scribe-notes-2.pdf].</p>
<p>Usage-mostly first pass.</p>
<h1 id="privacy-and-gdpr">Privacy and GDPR<a aria-hidden="true" class="anchor-heading icon-link" href="#privacy-and-gdpr"></a></h1>
<p></p><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Algorithmic Privacy, Right to be Forgotten</span></div>
<a href="/PublicPersonalKnowledgeBase/notes/t2Y26zj67xbb8TvJ4apR0" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><h1 id="privacy-and-gdpr-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^gdpr" href="#^gdpr"></a>Privacy and GDPR <a aria-hidden="true" class="anchor-heading icon-link" href="#privacy-and-gdpr-"></a></h1>
<p> E.g. in the context of <a href="/PublicPersonalKnowledgeBase/notes/VG6JMpj1Lic8br5iTSvIL">Recommender Systems</a>, we could delete the user data and then use the cold start models</p>
</div></div><p></p><p></p>
<h1 id="model-serving">Model Serving<a aria-hidden="true" class="anchor-heading icon-link" href="#model-serving"></a></h1>
<p>Tricky, thus the multi-step process.</p>
<h1 id="future-directions">Future Directions<a aria-hidden="true" class="anchor-heading icon-link" href="#future-directions"></a></h1>
<h1 id="improved-rnns--cold-starts-and-session-models">Improved RNN's : cold starts and session models<a aria-hidden="true" class="anchor-heading icon-link" href="#improved-rnns--cold-starts-and-session-models"></a></h1>
<h1 id="curther-research-on-contextual-models-as-well-as-content-and-metadata">curther research on contextual models, as well as content and metadata.<a aria-hidden="true" class="anchor-heading icon-link" href="#curther-research-on-contextual-models-as-well-as-content-and-metadata"></a></h1>
<h1 id="combining-sequence-and-historical-data-long-and-short-term-behavior">Combining sequence and historical data (long and short term behavior)<a aria-hidden="true" class="anchor-heading icon-link" href="#combining-sequence-and-historical-data-long-and-short-term-behavior"></a></h1>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/PublicPersonalKnowledgeBase/notes/JClhWanv6nT58jkwQvo3o">AB Testing</a></li>
<li><a href="/PublicPersonalKnowledgeBase/notes/GNXIZwCP8BdYPEsGMvUYO">Youyube Video Recommendation</a></li>
<li><a href="/PublicPersonalKnowledgeBase/notes/x6WJBarY2rinq6LZVpoAE">KNN</a></li>
</ul>