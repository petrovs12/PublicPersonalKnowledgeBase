<h1 id="designing-uber-backend">Designing Uber Backend<a aria-hidden="true" class="anchor-heading icon-link" href="#designing-uber-backend"></a></h1>
<p><a href="https://docs.google.com/drawings/d/1-kZWlP49_xPPXh3CmE_7g8WLbHwE2p6at4iVpGxwJj0/edit">Uber Backend</a>.</p>
<p></p><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Quad Tree</span></div>
<a href="/PublicPersonalKnowledgeBase/notes/stlANyohtrErNy8tZXnni" class="portal-arrow">Go to text <span class="right-arrow">â†’</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><p>Use a 'geographical quad-tree' to store all the locations of all the <strong>things of interest</strong>. The quad-tree is a tree where each node is a rectangle of size 2x2. Each node (except terminal ones) represents a location, and it's children split it into a southeast, northeast, northwest, and southwest quadrant.</p>
<p>So then a quad-tree is like a 2d version of the binary tree.</p>
<h1 id="parent-nodes-links-or-sibling-linked-list-connections">Parent Nodes links or Sibling Linked list connections<a aria-hidden="true" class="anchor-heading icon-link" href="#parent-nodes-links-or-sibling-linked-list-connections"></a></h1>
<p>So we can more easily expand the search area: search up, then do DFS/BFS from there.
With the sibling linked list- also clear what to do.</p>
</div></div><p></p><p></p>
<p>We can use this to store the "long-term locations" of all drivers.
Updating it might be a bit costly, as they constantly move around, BUT we can do as follows:</p>
<p>When a user requests a ride, we can check top drivers in their area and see their location in the quad-tree. Say the quad-tree is updated every minute or 15 seconds. </p>
<p>In addition, every driver sends their current location back every 3 seconds, but this is not reflected
in the quad-tree as often, as it's a bit expensive to update.</p>
<p>Every driver represents a topic in a <a href="/PublicPersonalKnowledgeBase/notes/XTtqgXn9cjxfiseCY7KSn">Message Queues</a>, to which topic all
customers, interested in them, are subscribed (via the mobile client).</p>
<p>Thus a rider can request more general info on all drivers from the quad-tree (every 15 seconds), but
can track the locations of drivers they are subscribed to much more efficiently (every 3 seconds).</p>
<p>These subscriptions will be normally terminated when a ride is confirmed.</p>