<h1 id="kats">KATS<a aria-hidden="true" class="anchor-heading icon-link" href="#kats"></a></h1>
<h1 id="timeseriesdata--obbject">TimeSeriesData  obbject<a aria-hidden="true" class="anchor-heading icon-link" href="#timeseriesdata--obbject"></a></h1>
<p>like ts in R, or mts in R.
just a pandas dataframe with some additional stuff. </p>
<p>Can convert from and to a pandas DF</p>
<h1 id="forecasting-with-kats">Forecasting with KATS<a aria-hidden="true" class="anchor-heading icon-link" href="#forecasting-with-kats"></a></h1>
<p>10 Basic forecasting models</p>
<ol>
<li>Linear</li>
<li>Quadratic</li>
<li>ARIMA</li>
<li>SARIMA</li>
<li>Holt-Winters</li>
<li>Prophet</li>
<li>AR-Net</li>
<li>LSTM</li>
<li>Theta</li>
<li>VAR</li>
</ol>
<p>  -- Not obvious how to do
k-step ahead out of sample predictions with KATS.</p>
<h1 id="httpsfacebookresearchgithubiokatsapi_moduleskatsmodelslstmhtmllstmmodelpredict"><a href="https://facebookresearch.github.io/Kats/api/_modules/kats/models/lstm.html#LSTMModel.predict">https://facebookresearch.github.io/Kats/api/_modules/kats/models/lstm.html#LSTMModel.predict</a><a aria-hidden="true" class="anchor-heading icon-link" href="#httpsfacebookresearchgithubiokatsapi_moduleskatsmodelslstmhtmllstmmodelpredict"></a></h1>
<p>However, BackTester is a way to do this...</p>
<h1 id="kats-backtestershttpsfacebookresearchgithubiokatsapikatsutilsbacktestershtml">(KATS Backtesters)[https://facebookresearch.github.io/Kats/api/kats.utils.backtesters.html]<a aria-hidden="true" class="anchor-heading icon-link" href="#kats-backtestershttpsfacebookresearchgithubiokatsapikatsutilsbacktestershtml"></a></h1>
<p>The <strong>frequency</strong> parameter is usually in the 'fit' function.</p>
<p>Probably kwargs in the Backtest model are passed to the 'fit' model, or maybe the 'predict' function.</p>
<p>Actually kwargs is just passed to the parent class constructor.</p>
<p> I think it's pased to both, maybe...</p>
<h1 id="inferring-frequency">Inferring frequency<a aria-hidden="true" class="anchor-heading icon-link" href="#inferring-frequency"></a></h1>
<p> Kats uses <a href="/PublicPersonalKnowledgeBase/">pandas infer freq function</a>
<a href="https://pandas.pydata.org/docs/reference/api/pandas.infer_freq.html">https://pandas.pydata.org/docs/reference/api/pandas.infer_freq.html</a></p>
<h1 id="nb--use-cross-validation">NB : Use Cross Validation<a aria-hidden="true" class="anchor-heading icon-link" href="#nb--use-cross-validation"></a></h1>
<p>rolling vs expanding window, etc...</p>
<h1 id="kats---out-of-sample-step-ahead-forecasting">KATS - out of sample step-ahead forecasting<a aria-hidden="true" class="anchor-heading icon-link" href="#kats---out-of-sample-step-ahead-forecasting"></a></h1>
<p><a href="https://facebookresearch.github.io/Kats/api/kats.models.arima.html">https://facebookresearch.github.io/Kats/api/kats.models.arima.html</a></p>
<p>Here inthe arima, there are <strong>start_params</strong>, and iteration limit...</p>
<h1 id="kats-prophet">KATS Prophet<a aria-hidden="true" class="anchor-heading icon-link" href="#kats-prophet"></a></h1>
<p>In the ProphetParams, there is somethign about holidays...</p>
<p>There is a <a href="/PublicPersonalKnowledgeBase/httpshttps://github.com/facebookresearch/Kats/pull/129">PR request</a> for this..</p>
<p>From <a href="https://bytemeta.vip/repo/facebookresearch/Kats/issues/167">here</a></p>
<pre class="language-{python}"><code class="language-{python}">from kats.models.prophet import ProphetModel, ProphetParams

air_passengers_ts = TimeSeriesData(air_passengers_df) reg = np.random.randn(len(air_passengers_ts))

pparams = ProphetParams(extra_regressors = [{'value': reg, 'name':'reg1'}])

pmodel = ProphetModel(data=air_passengers_ts, params=pparams)

pmodel.fit()

pmodel.predict(steps=20, extra_regressors = [{'value': np.random.randn(20), 'name':'reg1'}])`
</code></pre>
<h1 id="low-hanging-fruit">Low-hanging fruit..<a aria-hidden="true" class="anchor-heading icon-link" href="#low-hanging-fruit"></a></h1>
<h2 id="general">General<a aria-hidden="true" class="anchor-heading icon-link" href="#general"></a></h2>
<ol start="0">
<li>Use log1p -> exp(x)-1  to avoid predictions bellow 0...</li>
<li>Featurization:
Use Patrons forecast as a feature in a regression/auto-regressive model
Moving averages over different time windows:
Previous 3 working days, mean and median for last week month, quarter, same quarter last year, a same week last year (if available).
1/ (#days after last holiday). #days since the start of the semester and until the end of the semester.</li>
</ol>
<h1 id="of-days-since-the-start-of-last-lockdown">of days since the start of last lockdown.<a aria-hidden="true" class="anchor-heading icon-link" href="#of-days-since-the-start-of-last-lockdown"></a></h1>
<p>Using patrons forecast for that date (as a version of a model stacking).</p>
<p> -- Observation weights not included in Prophet At the moment</p>
<ul>
<li>Use Arima as Baseline model</li>
</ul>
<h1 id="solving-the-bad-observational-periods-issue">Solving the 'bad observational periods' issue<a aria-hidden="true" class="anchor-heading icon-link" href="#solving-the-bad-observational-periods-issue"></a></h1>
<ol>
<li>for each time series, fit <a href="https://scikit-learn.org/stable/modules/mixture.html">Gaussian Mixture model</a> to check for 'abnormal periods'. Alternatively, they may be defined manually.</li>
<li>For each time series, mark the 'abnormal' periods that have mean &#x3C;=1/3 of the mean of the cluster of largest values, as missing/NaN.</li>
<li>Inpute the NaN's with <a href="https://pypi.org/project/autoimpute/">https://pypi.org/project/autoimpute/</a>, spline feature.</li>
</ol>
<h2 id="event-and-holiday-modeling">Event and Holiday Modeling<a aria-hidden="true" class="anchor-heading icon-link" href="#event-and-holiday-modeling"></a></h2>
<p>Add events. For the prophet model, can do it directly in the prophet constructor.</p>
<h2 id="external-regressors-w-lstm">External regressors w/ LSTM<a aria-hidden="true" class="anchor-heading icon-link" href="#external-regressors-w-lstm"></a></h2>
<p>Add external regressors as an extension of the input vectors...
Should be easy to also add the the out of sample several-steps ahead things.</p>
<h2 id="split-and-aggregate">Split and aggregate<a aria-hidden="true" class="anchor-heading icon-link" href="#split-and-aggregate"></a></h2>
<p>Notes from
<a href="https://towardsdatascience.com/the-best-deep-learning-models-for-time-series-forecasting-690767bc63f0">Best DL Learning MNodels for TS</a></p>
<p>there is an implementation of N-Beats in darts</p>
<p><a href="https://github.com/QData/spacetimeformer">https://github.com/QData/spacetimeformer</a></p>