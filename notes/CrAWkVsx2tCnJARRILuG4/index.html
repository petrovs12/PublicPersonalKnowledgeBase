<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/PublicPersonalKnowledgeBase/favicon.ico"/><title>Doordash Talk</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal knowledge space"/><meta property="og:title" content="Doordash Talk"/><meta property="og:description" content="Personal knowledge space"/><meta property="og:url" content="https://petrovs12.github.io/PublicPersonalKnowledgeBase/notes/CrAWkVsx2tCnJARRILuG4/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2/10/2022"/><meta property="article:modified_time" content="2/13/2022"/><link rel="canonical" href="https://petrovs12.github.io/PublicPersonalKnowledgeBase/notes/CrAWkVsx2tCnJARRILuG4/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/PublicPersonalKnowledgeBase/_next/static/css/7719b08cc3352912.css" as="style"/><link rel="stylesheet" href="/PublicPersonalKnowledgeBase/_next/static/css/7719b08cc3352912.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/PublicPersonalKnowledgeBase/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/PublicPersonalKnowledgeBase/_next/static/chunks/webpack-b320c149a25b986a.js" defer=""></script><script src="/PublicPersonalKnowledgeBase/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/PublicPersonalKnowledgeBase/_next/static/chunks/main-8915ee191b7710e8.js" defer=""></script><script src="/PublicPersonalKnowledgeBase/_next/static/chunks/pages/_app-bf98b80149ea852b.js" defer=""></script><script src="/PublicPersonalKnowledgeBase/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/PublicPersonalKnowledgeBase/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/PublicPersonalKnowledgeBase/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/PublicPersonalKnowledgeBase/_next/static/d47oHCd-7QAOR5IvSuJke/_buildManifest.js" defer=""></script><script src="/PublicPersonalKnowledgeBase/_next/static/d47oHCd-7QAOR5IvSuJke/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="doordash-talk">Doordash Talk<a aria-hidden="true" class="anchor-heading icon-link" href="#doordash-talk"></a></h1>
<p>from <img src="https://www.youtube.com/watch?v=sEZsIUBIhNk&#x26;list=PLmGsNPZGeM5D8fgr2scwe8wZih4SYB7Vt&#x26;ab_channel=InfoQ"></p>
<p>Real world ML systems:</p>
<div class="mermaid">
  graph LR;
A(Data Pipeline)-->B(Model Deployment/Management)-->C(Model Monitoring/Evaluation)
</div>
<p>Real world ML systems:
10% algorithms
90% ml systems</p>
<p>How to return the focus to the algorithms:</p>
<h1 id="ml-systems">ML Systems<a aria-hidden="true" class="anchor-heading icon-link" href="#ml-systems"></a></h1>
<p>Robust tools + templatzize best practices</p>
<h2 id="doordash-overview">DoorDash overview<a aria-hidden="true" class="anchor-heading icon-link" href="#doordash-overview"></a></h2>
<ul>
<li>Last mile on-demand logistics</li>
<li>3 sided marketplace (users, restaurants, delivery service)</li>
<li>1600 cities by end of 2018</li>
</ul>
<p>Technology company</p>
<p>Connecting the 3-sided marketplace.</p>
<p>Mostly restaurant delivery.</p>
<p>100000+ resraurants.
300000 delivery drivers.
10^10^6 deliveries.</p>
<h3 id="goals-of-users-"><a aria-hidden="true" class="block-anchor anchor-heading icon-link" id="^usergoals" href="#^usergoals"></a>Goals of users: <a aria-hidden="true" class="anchor-heading icon-link" href="#goals-of-users-"></a></h3>
<p><a href="/PublicPersonalKnowledgeBase/notes/5e3lyw7ea2a9fjxm4y3hlqp">Personas</a></p>
<h3 id="restaurants">Restaurants:<a aria-hidden="true" class="anchor-heading icon-link" href="#restaurants"></a></h3>
<p>reach and revenie</p>
<h3 id="delivery-service">Delivery Service:<a aria-hidden="true" class="anchor-heading icon-link" href="#delivery-service"></a></h3>
<p>Flexibility and earnings</p>
<h3 id="users">Users:<a aria-hidden="true" class="anchor-heading icon-link" href="#users"></a></h3>
<p>Convenience and seleciton</p>
<p>Between the above sides, there are multiple ml algorithms:</p>
<h2 id="users-restaurants">Users-Restaurants:<a aria-hidden="true" class="anchor-heading icon-link" href="#users-restaurants"></a></h2>
<p>Recyss- recommendation/personalization, search ranking, demand prediction.</p>
<h2 id="merchants---drivers">Merchants - Drivers:<a aria-hidden="true" class="anchor-heading icon-link" href="#merchants---drivers"></a></h2>
<p>Core dispatch algorithm
Hotspots
Batching of orders/etc</p>
<p>Seems like the usual VRP stuff...</p>
<h1 id="merchants">Merchants:<a aria-hidden="true" class="anchor-heading icon-link" href="#merchants"></a></h1>
<p>food prep time
parking prediction
selection intelligence (e.g. what things are ppl going to order, how to structure the menu maybe, etc..)
combine demand spikes etc</p>
<h1 id="users-1">Users<a aria-hidden="true" class="anchor-heading icon-link" href="#users-1"></a></h1>
<p>lifetime value
promotions
aquisition</p>
<h1 id="delivery-service-1">Delivery Service<a aria-hidden="true" class="anchor-heading icon-link" href="#delivery-service-1"></a></h1>
<p>Supply calculation
Pay calculation (effort-based)
Incentives</p>
<h1 id="offline-batch-to-online-on-demand-axis">Offline (batch) to online (on-demand) axis<a aria-hidden="true" class="anchor-heading icon-link" href="#offline-batch-to-online-on-demand-axis"></a></h1>
<p>reccomendation might be offline (in this case) so offline
time prediction -online
demand forecasting in the middle (multiple horizons).</p>
<h1 id="training-pipeline">Training Pipeline<a aria-hidden="true" class="anchor-heading icon-link" href="#training-pipeline"></a></h1>
<div class="mermaid">
  graph LR;
F[Common Features Store]-->B
A[(Data)]-->B("Features Extractor")-->C("Model Training Jobs")-->D[(Model Repo)]

</div>
<p><a title="Private" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank" class="private">Feature Stores (Private)</a> are great/super important.</p>
<p>They serve as a single source of truth, store embeddings etc.</p>
<h1 id="ml-performance-goals">ML Performance goals<a aria-hidden="true" class="anchor-heading icon-link" href="#ml-performance-goals"></a></h1>
<ul>
<li>Accuracy SLAs</li>
<li>System SLAs  (latency)</li>
<li>Debuggability*</li>
<li>Time to Ship </li>
</ul>
<h1 id="debuggability-goals">Debuggability goals<a aria-hidden="true" class="anchor-heading icon-link" href="#debuggability-goals"></a></h1>
<p> If some model is giving weird results, what do you do? What tooling do you need so you can quickly decide if it's a data issue, model going stale issue, or something else? What</p>
<h1 id="stefans-own-musings">Stefan's own musings<a aria-hidden="true" class="anchor-heading icon-link" href="#stefans-own-musings"></a></h1>
<p>Let's have some such structure:</p>
<div class="mermaid">
  graph LR;

D[Model Repository]--model-->I
A[Request]-->B[Load Balancer]--"json_data{user_id:1,restaurant_id:2,type:parking,...,timestamp}"-->C[Predict]
D[(Model Repository)]--Shadow Model-->I

I[Model Service]-.-C

F[(Feature Store)]--"fetch data for entities, last entry&#x3C;=Timestamp"-->C
E[(Model Log)]
G[("Model Metrics and Monitoring")]
E-.->G
C--"features, predictions"-->E

A1[Model Metadata]-.->D
H[S3]--->D


</div>
<p>The model log holds all request, feature values, predictions, and outcomes</p>
<h2 id="shadowing-models">Shadowing models<a aria-hidden="true" class="anchor-heading icon-link" href="#shadowing-models"></a></h2>
<p>Run models in parallel, as well as on the different groups. Use the parallel models for counterfactual stuff.</p>
<h2 id="use-the-model-log-to-replay-stuff">Use the model log to replay stuff<a aria-hidden="true" class="anchor-heading icon-link" href="#use-the-model-log-to-replay-stuff"></a></h2>
<h2 id="use-log-for-monitoring">Use log for monitoring<a aria-hidden="true" class="anchor-heading icon-link" href="#use-log-for-monitoring"></a></h2>
<p><a href="/PublicPersonalKnowledgeBase/notes/Zh0txnUCi8NGy872tQhGN">Distribution Drift</a></p>
<h2 id="use-log-to-train-new-models">Use log to train new models<a aria-hidden="true" class="anchor-heading icon-link" href="#use-log-to-train-new-models"></a></h2>
<p>Thus making the training and prediction processes closer (modulo effect on customer behavior).</p>
<h1 id="monitor">Monitor<a aria-hidden="true" class="anchor-heading icon-link" href="#monitor"></a></h1>
<ul>
<li>Feature Distributions</li>
<li>Predictions</li>
<li>Response times</li>
</ul>
<p>track summary stats, plot distributions, alert.</p>
<h1 id="launching-new-models">Launching new models<a aria-hidden="true" class="anchor-heading icon-link" href="#launching-new-models"></a></h1>
<p>Much faser now, as now the process is as follows:</p>
<div class="mermaid">
  graph TD;
a[Model Ready]--"Model Registry Knows how to serve model"-->B[Register Model Metadata]
B--"Can test as shadow as a stage before AB test"-->C
C["Enable Shadow/experiment"]-->D[Monitor Metrics]



</div>
<h1 id="data-preparation">Data Preparation<a aria-hidden="true" class="anchor-heading icon-link" href="#data-preparation"></a></h1>
<p>While doing data prep, it would be ideal to integrate with the feature store.</p>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/PublicPersonalKnowledgeBase/notes/5e3lyw7ea2a9fjxm4y3hlqp">Personas</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#ml-systems" title="ML Systems">ML Systems</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#doordash-overview" title="DoorDash overview">DoorDash overview</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#goals-of-users" title="Goals of users:">Goals of users:</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#restaurants" title="Restaurants:">Restaurants:</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#delivery-service" title="Delivery Service:">Delivery Service:</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#users" title="Users:">Users:</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#users-restaurants" title="Users-Restaurants:">Users-Restaurants:</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#merchants---drivers" title="Merchants - Drivers:">Merchants - Drivers:</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#merchants" title="Merchants:">Merchants:</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#users-1" title="Users">Users</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#delivery-service-1" title="Delivery Service">Delivery Service</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#offline-batch-to-online-on-demand-axis" title="Offline (batch) to online (on-demand) axis">Offline (batch) to online (on-demand) axis</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#training-pipeline" title="Training Pipeline">Training Pipeline</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#ml-performance-goals" title="ML Performance goals">ML Performance goals</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#debuggability-goals" title="Debuggability goals">Debuggability goals</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#stefans-own-musings" title="Stefan&#x27;s own musings">Stefan&#x27;s own musings</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#shadowing-models" title="Shadowing models">Shadowing models</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#use-the-model-log-to-replay-stuff" title="Use the model log to replay stuff">Use the model log to replay stuff</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#use-log-for-monitoring" title="Use log for monitoring">Use log for monitoring</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#use-log-to-train-new-models" title="Use log to train new models">Use log to train new models</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#monitor" title="Monitor">Monitor</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#launching-new-models" title="Launching new models">Launching new models</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#data-preparation" title="Data Preparation">Data Preparation</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"CrAWkVsx2tCnJARRILuG4","title":"Doordash Talk","desc":"","updated":1644775346263,"created":1644531139053,"custom":{},"fname":"engineering.system_design,,Ml System Design.Doordash Talk","type":"note","vault":{"fsPath":"vault"},"contentHash":"8e2f79851fb9acedbd10f18aec2f9aec","links":[{"type":"wiki","from":{"fname":"engineering.system_design,,Ml System Design.Doordash Talk","id":"CrAWkVsx2tCnJARRILuG4","vaultName":"vault"},"value":"seed.Product Management.Personas","position":{"start":{"line":33,"column":1,"offset":725},"end":{"line":33,"column":37,"offset":761},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"seed.Product Management.Personas"}},{"type":"wiki","from":{"fname":"engineering.system_design,,Ml System Design.Doordash Talk","id":"CrAWkVsx2tCnJARRILuG4","vaultName":"vault"},"value":"Feature Stores","position":{"start":{"line":94,"column":1,"offset":1814},"end":{"line":94,"column":19,"offset":1832},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"Feature Stores"}},{"type":"wiki","from":{"fname":"engineering.system_design,,Ml System Design.Doordash Talk","id":"CrAWkVsx2tCnJARRILuG4","vaultName":"vault"},"value":"science.stats.Distribution Drift","position":{"start":{"line":146,"column":1,"offset":2990},"end":{"line":146,"column":37,"offset":3026},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"science.stats.Distribution Drift"}},{"from":{"fname":"seed.Product Management.Personas","id":"5e3lyw7ea2a9fjxm4y3hlqp","vaultName":"vault"},"type":"backlink","position":{"start":{"line":87,"column":5,"offset":2123},"end":{"line":87,"column":77,"offset":2195},"indent":[]},"value":"engineering.system_design,,Ml System Design.Doordash Talk"}],"anchors":{"ml-systems":{"type":"header","text":"ML Systems","value":"ml-systems","line":20,"column":0,"depth":1},"doordash-overview":{"type":"header","text":"DoorDash overview","value":"doordash-overview","line":23,"column":0,"depth":2},"goals-of-users":{"type":"header","text":"Goals of users:","value":"goals-of-users","line":37,"column":0,"depth":3},"restaurants":{"type":"header","text":"Restaurants:","value":"restaurants","line":40,"column":0,"depth":3},"delivery-service":{"type":"header","text":"Delivery Service:","value":"delivery-service","line":43,"column":0,"depth":3},"users":{"type":"header","text":"Users:","value":"users","line":46,"column":0,"depth":3},"users-restaurants":{"type":"header","text":"Users-Restaurants:","value":"users-restaurants","line":51,"column":0,"depth":2},"merchants---drivers":{"type":"header","text":"Merchants - Drivers:","value":"merchants---drivers","line":54,"column":0,"depth":2},"merchants":{"type":"header","text":"Merchants:","value":"merchants","line":63,"column":0,"depth":1},"users-1":{"type":"header","text":"Users","value":"users-1","line":71,"column":0,"depth":1},"delivery-service-1":{"type":"header","text":"Delivery Service","value":"delivery-service-1","line":76,"column":0,"depth":1},"offline-batch-to-online-on-demand-axis":{"type":"header","text":"Offline (batch) to online (on-demand) axis","value":"offline-batch-to-online-on-demand-axis","line":83,"column":0,"depth":1},"training-pipeline":{"type":"header","text":"Training Pipeline","value":"training-pipeline","line":90,"column":0,"depth":1},"ml-performance-goals":{"type":"header","text":"ML Performance goals","value":"ml-performance-goals","line":105,"column":0,"depth":1},"debuggability-goals":{"type":"header","text":"Debuggability goals","value":"debuggability-goals","line":112,"column":0,"depth":1},"stefans-own-musings":{"type":"header","text":"Stefan's own musings","value":"stefans-own-musings","line":117,"column":0,"depth":1},"shadowing-models":{"type":"header","text":"Shadowing models","value":"shadowing-models","line":144,"column":0,"depth":2},"use-the-model-log-to-replay-stuff":{"type":"header","text":"Use the model log to replay stuff","value":"use-the-model-log-to-replay-stuff","line":148,"column":0,"depth":2},"use-log-for-monitoring":{"type":"header","text":"Use log for monitoring","value":"use-log-for-monitoring","line":151,"column":0,"depth":2},"use-log-to-train-new-models":{"type":"header","text":"Use log to train new models","value":"use-log-to-train-new-models","line":154,"column":0,"depth":2},"monitor":{"type":"header","text":"Monitor","value":"monitor","line":159,"column":0,"depth":1},"launching-new-models":{"type":"header","text":"Launching new models","value":"launching-new-models","line":166,"column":0,"depth":1},"data-preparation":{"type":"header","text":"Data Preparation","value":"data-preparation","line":180,"column":0,"depth":1},"^usergoals":{"type":"block","value":"usergoals","line":37,"column":20}},"children":[],"parent":"mR1xZlMX1ULyWEc6esPWa","data":{}},"body":"\u003ch1 id=\"doordash-talk\"\u003eDoordash Talk\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#doordash-talk\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003efrom \u003cimg src=\"https://www.youtube.com/watch?v=sEZsIUBIhNk\u0026#x26;list=PLmGsNPZGeM5D8fgr2scwe8wZih4SYB7Vt\u0026#x26;ab_channel=InfoQ\"\u003e\u003c/p\u003e\n\u003cp\u003eReal world ML systems:\u003c/p\u003e\n\u003cdiv class=\"mermaid\"\u003e\n  graph LR;\nA(Data Pipeline)--\u003eB(Model Deployment/Management)--\u003eC(Model Monitoring/Evaluation)\n\u003c/div\u003e\n\u003cp\u003eReal world ML systems:\n10% algorithms\n90% ml systems\u003c/p\u003e\n\u003cp\u003eHow to return the focus to the algorithms:\u003c/p\u003e\n\u003ch1 id=\"ml-systems\"\u003eML Systems\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#ml-systems\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eRobust tools + templatzize best practices\u003c/p\u003e\n\u003ch2 id=\"doordash-overview\"\u003eDoorDash overview\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#doordash-overview\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eLast mile on-demand logistics\u003c/li\u003e\n\u003cli\u003e3 sided marketplace (users, restaurants, delivery service)\u003c/li\u003e\n\u003cli\u003e1600 cities by end of 2018\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eTechnology company\u003c/p\u003e\n\u003cp\u003eConnecting the 3-sided marketplace.\u003c/p\u003e\n\u003cp\u003eMostly restaurant delivery.\u003c/p\u003e\n\u003cp\u003e100000+ resraurants.\n300000 delivery drivers.\n10^10^6 deliveries.\u003c/p\u003e\n\u003ch3 id=\"goals-of-users-\"\u003e\u003ca aria-hidden=\"true\" class=\"block-anchor anchor-heading icon-link\" id=\"^usergoals\" href=\"#^usergoals\"\u003e\u003c/a\u003eGoals of users: \u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#goals-of-users-\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"/PublicPersonalKnowledgeBase/notes/5e3lyw7ea2a9fjxm4y3hlqp\"\u003ePersonas\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"restaurants\"\u003eRestaurants:\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#restaurants\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003ereach and revenie\u003c/p\u003e\n\u003ch3 id=\"delivery-service\"\u003eDelivery Service:\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#delivery-service\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eFlexibility and earnings\u003c/p\u003e\n\u003ch3 id=\"users\"\u003eUsers:\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#users\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eConvenience and seleciton\u003c/p\u003e\n\u003cp\u003eBetween the above sides, there are multiple ml algorithms:\u003c/p\u003e\n\u003ch2 id=\"users-restaurants\"\u003eUsers-Restaurants:\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#users-restaurants\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eRecyss- recommendation/personalization, search ranking, demand prediction.\u003c/p\u003e\n\u003ch2 id=\"merchants---drivers\"\u003eMerchants - Drivers:\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#merchants---drivers\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eCore dispatch algorithm\nHotspots\nBatching of orders/etc\u003c/p\u003e\n\u003cp\u003eSeems like the usual VRP stuff...\u003c/p\u003e\n\u003ch1 id=\"merchants\"\u003eMerchants:\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#merchants\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003efood prep time\nparking prediction\nselection intelligence (e.g. what things are ppl going to order, how to structure the menu maybe, etc..)\ncombine demand spikes etc\u003c/p\u003e\n\u003ch1 id=\"users-1\"\u003eUsers\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#users-1\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003elifetime value\npromotions\naquisition\u003c/p\u003e\n\u003ch1 id=\"delivery-service-1\"\u003eDelivery Service\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#delivery-service-1\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eSupply calculation\nPay calculation (effort-based)\nIncentives\u003c/p\u003e\n\u003ch1 id=\"offline-batch-to-online-on-demand-axis\"\u003eOffline (batch) to online (on-demand) axis\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#offline-batch-to-online-on-demand-axis\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003ereccomendation might be offline (in this case) so offline\ntime prediction -online\ndemand forecasting in the middle (multiple horizons).\u003c/p\u003e\n\u003ch1 id=\"training-pipeline\"\u003eTraining Pipeline\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#training-pipeline\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cdiv class=\"mermaid\"\u003e\n  graph LR;\nF[Common Features Store]--\u003eB\nA[(Data)]--\u003eB(\"Features Extractor\")--\u003eC(\"Model Training Jobs\")--\u003eD[(Model Repo)]\n\n\u003c/div\u003e\n\u003cp\u003e\u003ca title=\"Private\" href=\"https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html\" target=\"_blank\" class=\"private\"\u003eFeature Stores (Private)\u003c/a\u003e are great/super important.\u003c/p\u003e\n\u003cp\u003eThey serve as a single source of truth, store embeddings etc.\u003c/p\u003e\n\u003ch1 id=\"ml-performance-goals\"\u003eML Performance goals\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#ml-performance-goals\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eAccuracy SLAs\u003c/li\u003e\n\u003cli\u003eSystem SLAs  (latency)\u003c/li\u003e\n\u003cli\u003eDebuggability*\u003c/li\u003e\n\u003cli\u003eTime to Ship \u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"debuggability-goals\"\u003eDebuggability goals\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#debuggability-goals\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003e If some model is giving weird results, what do you do? What tooling do you need so you can quickly decide if it's a data issue, model going stale issue, or something else? What\u003c/p\u003e\n\u003ch1 id=\"stefans-own-musings\"\u003eStefan's own musings\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#stefans-own-musings\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eLet's have some such structure:\u003c/p\u003e\n\u003cdiv class=\"mermaid\"\u003e\n  graph LR;\n\nD[Model Repository]--model--\u003eI\nA[Request]--\u003eB[Load Balancer]--\"json_data{user_id:1,restaurant_id:2,type:parking,...,timestamp}\"--\u003eC[Predict]\nD[(Model Repository)]--Shadow Model--\u003eI\n\nI[Model Service]-.-C\n\nF[(Feature Store)]--\"fetch data for entities, last entry\u0026#x3C;=Timestamp\"--\u003eC\nE[(Model Log)]\nG[(\"Model Metrics and Monitoring\")]\nE-.-\u003eG\nC--\"features, predictions\"--\u003eE\n\nA1[Model Metadata]-.-\u003eD\nH[S3]---\u003eD\n\n\n\u003c/div\u003e\n\u003cp\u003eThe model log holds all request, feature values, predictions, and outcomes\u003c/p\u003e\n\u003ch2 id=\"shadowing-models\"\u003eShadowing models\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#shadowing-models\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eRun models in parallel, as well as on the different groups. Use the parallel models for counterfactual stuff.\u003c/p\u003e\n\u003ch2 id=\"use-the-model-log-to-replay-stuff\"\u003eUse the model log to replay stuff\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#use-the-model-log-to-replay-stuff\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch2 id=\"use-log-for-monitoring\"\u003eUse log for monitoring\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#use-log-for-monitoring\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"/PublicPersonalKnowledgeBase/notes/Zh0txnUCi8NGy872tQhGN\"\u003eDistribution Drift\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"use-log-to-train-new-models\"\u003eUse log to train new models\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#use-log-to-train-new-models\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThus making the training and prediction processes closer (modulo effect on customer behavior).\u003c/p\u003e\n\u003ch1 id=\"monitor\"\u003eMonitor\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#monitor\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eFeature Distributions\u003c/li\u003e\n\u003cli\u003ePredictions\u003c/li\u003e\n\u003cli\u003eResponse times\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003etrack summary stats, plot distributions, alert.\u003c/p\u003e\n\u003ch1 id=\"launching-new-models\"\u003eLaunching new models\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#launching-new-models\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eMuch faser now, as now the process is as follows:\u003c/p\u003e\n\u003cdiv class=\"mermaid\"\u003e\n  graph TD;\na[Model Ready]--\"Model Registry Knows how to serve model\"--\u003eB[Register Model Metadata]\nB--\"Can test as shadow as a stage before AB test\"--\u003eC\nC[\"Enable Shadow/experiment\"]--\u003eD[Monitor Metrics]\n\n\n\n\u003c/div\u003e\n\u003ch1 id=\"data-preparation\"\u003eData Preparation\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#data-preparation\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eWhile doing data prep, it would be ideal to integrate with the feature store.\u003c/p\u003e\n\u003chr\u003e\n\u003cstrong\u003eBacklinks\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/PublicPersonalKnowledgeBase/notes/5e3lyw7ea2a9fjxm4y3hlqp\"\u003ePersonas\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"wn8PE1RhG0znK1alrGFYv","title":"Root","desc":"","updated":1647507231129,"created":1631901573363,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"db285659ccac8b133c384de1ef51de66","links":[],"anchors":{"welcome-to-stefans-notes":{"type":"header","text":"Welcome to Stefan's Notes!","value":"welcome-to-stefans-notes","line":7,"column":0,"depth":1}},"children":["mxzxxu8z4e6krz99ht96y9d","W1EOZ27Tqx6RbiA2aW3DI","DyoLE2kwm9rRfRZhBGxPW","idhfogizmtcmvaamtalp3o3","4w8wBCSRvYUnGIZeozW03","vB321AipYCs6ldVC0APs9","h6WVdl1UTWVXeWuMJSZ1f","bth6m0exy9q9loxib1mc4al","4abAmH56ausbldEJbZokx","JyOFJ5NTPSVWMfiDy951X","0OO7fjCpcaGZg5qDRZr8z","138666663","pohXgII67dAxnoufG7yAP","6hs48bnjnaoxahk07exj74u","42r6290iqzLPmg9BY7fIp","3hoLerNJHjNkDziIKlFF2","T6meT3UNw0nRorEbzoPSl","hIOTXIIBj3vmhG1xc91lA","tnFlQuOAGPkbU2fZI7Cb1","Jb3w3f4x8kixLhrjUW6S1","LV6q5jlD2xtCF6yYFEqFC","ENDcCZFjAW9h66eDoFg7I","b5IeREnsTbeggC7rmWV0p","2hmbhdzcdljtdwln762gcrv","z9la6u9t3xueldj2omf2gc6","9akeo93l6b026jmu4t6e7pw","sc24o4jglr9jg29qr5v0e44","0mt5ao8tbbz3z5mdwe0aer8","r7rvb6nal69nfb6ogqdadnm","xujx5iuxskj10o0ajpi109n","lyl1rzqz6zwcswpwh0kafrm","skpw697vlqdq3t3uqxpq5e3","a4tts3oc3oms7wuralrbzdc","13a1ufqh6o8yi9evw1u5kv5"],"parent":null,"data":{},"body":"# Welcome to Stefan's Notes!\n\n        \n\nLast updated: 2021.12.30\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"enableUserTags":true,"enableHashTags":true,"dendronVersion":"0.95.0","enableEditorDecorations":true,"enableFullHierarchyNoteTitle":false,"templateHierarchy":"template"},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"Personal knowledge space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","assetsPrefix":"/PublicPersonalKnowledgeBase","siteUrl":"https://petrovs12.github.io","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"theme":"light","templateVersion":"0.97.0","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"CrAWkVsx2tCnJARRILuG4"},"buildId":"d47oHCd-7QAOR5IvSuJke","assetPrefix":"/PublicPersonalKnowledgeBase","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>